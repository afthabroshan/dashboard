<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Sales Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        /* Custom scrollbar for a cleaner look */
        #chatbox::-webkit-scrollbar {
            width: 6px;
        }

        #chatbox::-webkit-scrollbar-track {
            background: transparent;
        }

        #chatbox::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 3px;
        }

        #chatbox::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        .suggestion-chip {
            transition: all 0.2s ease-in-out;
        }

        .suggestion-chip:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
    </style>
</head>

<body class="bg-gray-100 flex flex-col h-screen">

    <!-- Navigation Bar -->
    <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-20">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0 flex items-center">
                    <i class="fas fa-chart-line text-blue-600 text-2xl mr-2"></i>
                    <a href="/" class="text-2xl font-bold text-gray-800">SalesDash</a>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="/"
                            class="text-gray-500 hover:bg-gray-100 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium">Home</a>
                        <a href="/ai" class="bg-blue-100 text-blue-700 px-3 py-2 rounded-md text-sm font-medium"
                            aria-current="page">AI Assistant</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Chat UI -->
    <main class="flex-grow container mx-auto p-4 sm:p-6 lg:p-8 flex items-center justify-center">
        <div
            class="w-full max-w-4xl h-[calc(100vh-120px)] bg-white border border-gray-200 rounded-2xl shadow-lg flex flex-col">
            <!-- Chat Header -->
            <div class="p-4 border-b border-gray-200 flex items-center justify-between">
                <div>
                    <h1 class="text-lg font-semibold text-gray-900">AI Sales Assistant</h1>
                    <div class="flex items-center text-sm text-gray-500">
                        <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                        <span>Online</span>
                    </div>
                </div>
                <button class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-ellipsis-h"></i>
                </button>
            </div>

            <!-- Messages Area -->
            <div id="chatbox" class="flex-grow p-6 space-y-6 overflow-y-auto">
                <!-- Initial AI Message & Suggestions -->
                <div class="flex items-start gap-3">
                    <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center">
                        <i class="fas fa-robot text-gray-600"></i>
                    </div>
                    <div class="flex flex-col gap-2 max-w-lg">
                        <div class="bg-gray-100 text-gray-800 p-3 rounded-r-lg rounded-bl-lg">
                            <p class="text-sm">Hello! I'm your AI Sales Assistant. I can help you find insights in your
                                sales data. What would you like to know?</p>
                        </div>
                        <div id="suggestion-chips" class="grid grid-cols-1 sm:grid-cols-2 gap-2 pt-2">
                            <button
                                class="suggestion-chip text-left text-sm text-gray-700 bg-white border border-gray-200 p-3 rounded-lg hover:bg-gray-50">What's
                                our best selling product?</button>
                            <button
                                class="suggestion-chip text-left text-sm text-gray-700 bg-white border border-gray-200 p-3 rounded-lg hover:bg-gray-50">Which
                                items are low on stock?</button>
                            <button
                                class="suggestion-chip text-left text-sm text-gray-700 bg-white border border-gray-200 p-3 rounded-lg hover:bg-gray-50">Show
                                me the sales trend this quarter.</button>
                            <button
                                class="suggestion-chip text-left text-sm text-gray-700 bg-white border border-gray-200 p-3 rounded-lg hover:bg-gray-50">Identify
                                the oldest items in inventory.</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="p-4 bg-white border-t border-gray-200">
                <form id="messageForm" class="relative">
                    <input id="messageInput" type="text" placeholder="Ask a question about your sales data..."
                        autocomplete="off"
                        class="w-full pl-4 pr-12 py-3 text-sm text-gray-800 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition" />
                    <button type="submit"
                        class="absolute inset-y-0 right-0 flex items-center justify-center w-12 text-gray-400 hover:text-blue-600 transition-colors">
                        <i class="fas fa-paper-plane text-xl"></i>
                    </button>
                </form>
            </div>
        </div>
    </main>

    <script>
        const messageForm = document.getElementById('messageForm');
        const messageInput = document.getElementById('messageInput');
        const chatbox = document.getElementById('chatbox');
        const suggestionChipsContainer = document.getElementById('suggestion-chips');

        // Handle form submission
        messageForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const userMessage = messageInput.value.trim();
            if (userMessage) {
                handleUserMessage(userMessage);
            }
        });

        // Handle suggestion chip clicks
        suggestionChipsContainer.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                const message = e.target.textContent;
                handleUserMessage(message);
            }
        });

        // Central function to process a user's message
        function handleUserMessage(message) {
            displayMessage(message, 'user');
            messageInput.value = '';
            // Hide suggestion chips after the first interaction
            if (suggestionChipsContainer) {
                suggestionChipsContainer.style.display = 'none';
            }
            simulateAIResponse(message);
        }

        // Function to add a message to the chatbox
        function displayMessage(message, sender) {
            const messageWrapper = document.createElement('div');
            messageWrapper.classList.add('flex', 'items-start', 'gap-3');

            const iconDiv = document.createElement('div');
            iconDiv.classList.add('w-8', 'h-8', 'rounded-full', 'flex-shrink-0', 'flex', 'items-center', 'justify-center');

            const messageBubble = document.createElement('div');
            messageBubble.classList.add('p-3', 'rounded-lg', 'max-w-lg', 'text-sm');

            if (sender === 'user') {
                messageWrapper.classList.add('justify-end');
                iconDiv.classList.add('bg-blue-500', 'text-white');
                iconDiv.innerHTML = '<i class="fas fa-user"></i>';
                messageBubble.classList.add('bg-blue-500', 'text-white', 'rounded-b-lg', 'rounded-tl-lg');
                messageWrapper.appendChild(messageBubble);
                messageWrapper.appendChild(iconDiv);
            } else { // AI
                messageWrapper.classList.add('justify-start');
                iconDiv.classList.add('bg-gray-200');
                iconDiv.innerHTML = '<i class="fas fa-robot text-gray-600"></i>';
                messageBubble.classList.add('bg-gray-100', 'text-gray-800', 'rounded-r-lg', 'rounded-bl-lg');
                messageWrapper.appendChild(iconDiv);
                messageWrapper.appendChild(messageBubble);
            }

            messageBubble.textContent = message;
            chatbox.appendChild(messageWrapper);

            // Scroll to the bottom
            chatbox.scrollTop = chatbox.scrollHeight;
        }

        // Function to show a "typing" indicator
        function showTypingIndicator() {
            const typingWrapper = document.createElement('div');
            typingWrapper.id = 'typing-indicator';
            typingWrapper.classList.add('flex', 'items-start', 'gap-3');
            typingWrapper.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center">
                    <i class="fas fa-robot text-gray-600"></i>
                </div>
                <div class="bg-gray-100 p-3 rounded-r-lg rounded-bl-lg flex items-center space-x-1.5">
                    <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0s;"></span>
                    <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0.2s;"></span>
                    <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse" style="animation-delay: 0.4s;"></span>
                </div>
            `;
            chatbox.appendChild(typingWrapper);
            chatbox.scrollTop = chatbox.scrollHeight;
        }

        // Function to remove the "typing" indicator
        function hideTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) {
                indicator.remove();
            }
        }

        // Simulate AI thinking and responding
        function simulateAIResponse(userMessage) {
            showTypingIndicator();

            setTimeout(() => {
                hideTypingIndicator();
                const aiResponse = getCannedResponse(userMessage);
                displayMessage(aiResponse, 'ai');
            }, 1500); // 1.5 second delay
        }

        // Pre-written AI responses based on keywords
        function getCannedResponse(userMessage) {
            const msg = userMessage.toLowerCase();
            if (msg.includes('top product') || msg.includes('best selling')) {
                return "Based on the latest data, the top-performing product is the 'ZX-5000 Industrial Widget' with a 45% increase in sales month-over-month.";
            }
            if (msg.includes('inventory') || msg.includes('stock')) {
                return "Currently, there are 15 items marked as 'low-stock'. The category with the lowest stock level is 'High-Performance Gaskets'. Would you like a detailed list?";
            }
            if (msg.includes('sales trend') || msg.includes('performance')) {
                return "Overall sales are trending up by 12% this quarter. The 'North' branch shows the highest growth at 22%, while the 'West' branch is lagging slightly.";
            }
            if (msg.includes('oldest') || msg.includes('ageing')) {
                return "The oldest item in stock is the 'Alpha-Coupling V2', which has been in inventory for 182 days. Clearing aged stock should be a priority.";
            }
            if (msg.includes('hello') || msg.includes('hi')) {
                return "Hello! How can I assist you with your sales data today?";
            }
            return "I can help with questions about sales, inventory, and product performance. For example, you could ask 'What is our top selling product?' or 'Show me the current inventory status'.";
        }
    </script>

</body>

</html>